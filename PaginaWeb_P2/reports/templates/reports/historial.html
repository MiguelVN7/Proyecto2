{% extends 'reports/base.html' %}
{% block content %}
<h1><i class="bi bi-clock-history"></i> Historial (HU#2)</h1>
<div class="card p-4 mt-4">
    <form method="get" class="row g-3">
        <div class="col-md-2"><input type="text" name="q" class="form-control" placeholder="Buscar..."></div>
        <div class="col-md-2"><input type="date" name="fecha_desde" class="form-control"></div>
        <div class="col-md-2"><input type="date" name="fecha_hasta" class="form-control"></div>
        <div class="col-md-2">
            <select name="tipo" class="form-select">
                <option value="">Todos</option>
                {% for v, l in tipos_disponibles %}<option value="{{ v }}">{{ l }}</option>{% endfor %}
            </select>
        </div>
        <div class="col-md-2"><button type="submit" class="btn btn-success w-100">Filtrar</button></div>
    </form>
</div>
<div class="card mt-4 p-4">
    <h5>Total Resueltos: {{ total_resueltos }}</h5>
    <table class="table mt-3">
        <tr><th>ID</th><th>Tipo</th><th>Ubicación</th><th>Fecha Reporte</th><th>Fecha Resolución</th><th>Notas</th></tr>
        {% for r in reportes %}
        <tr>
            <td>#{{ r.id }}</td>
            <td>{{ r.get_tipo_residuo_display }}</td>
            <td>{{ r.direccion|truncatewords:5 }}</td>
            <td>{{ r.fecha_reporte|date:"d/m/Y" }}</td>
            <td>{{ r.fecha_resolucion|date:"d/m/Y" }}</td>
            <td>{{ r.notas_resolucion|truncatewords:10 }}</td>
        </tr>
        {% empty %}<tr><td colspan="6" class="text-center">No hay reportes resueltos</td></tr>{% endfor %}
    </table>
</div>
{% endblock %}